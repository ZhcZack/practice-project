<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>高级动画</title>
	<style>
		canvas {
			border: 1px solid black;
		}
	</style>
</head>

<body>
	<canvas id="canvas" width="600" height="300"></canvas>
	<script>
		var canvas = document.querySelector('#canvas')
		var context = canvas.getContext('2d')
		var raf

		var ball = {
			x: 100,
			y: 100,
			radius: 25,
			color: 'blue',
			draw: function () {
				context.beginPath()
				context.arc(this.x, this.y, this.radius, 0, Math.PI * 2, true)
				context.closePath()
				context.fillStyle = this.color
				context.fill()
			},
			update: function () {
				if (ball.y + ball.radius >= canvas.height || ball.y - ball.radius <= 0) {
					ball.vy = -ball.vy;
				}
				if (ball.x + ball.radius >= canvas.width || ball.x - ball.radius <= 0) {
					ball.vx = -ball.vx;
				}
			},
			move: function () {
				this.x += this.vx
				this.y += this.vy

				this.vy *= 0.99
				this.vy += 0.25
			},
			vx: 5,
			vy: 2
		}

		function draw() {
			context.clearRect(0, 0, canvas.width, canvas.height)
			ball.draw()
			ball.move()
			ball.update()
			raf = window.requestAnimationFrame(draw)
		}

		canvas.addEventListener('mouseover', function (event) {
			raf = window.requestAnimationFrame(draw)
		})
		canvas.addEventListener('mouseout', function (event) {
			window.cancelAnimationFrame(raf)
		})

		ball.draw()
	</script>
</body>

</html>