<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>倒计时时钟</title>
</head>

<body>
	<div class="clock">
		<span></span>分钟<span></span>秒
	</div>
	<button>启动</button>
	<script>
		function main() {
			var button = document.querySelector('button')
			var timer = null
			var times = 3
			var ss = document.querySelectorAll('span')

			format(times)
			button.addEventListener('click', function (e) {
				if (timer) {
					clearInterval(timer)
					timer = null
					this.textContent = '启动'
				} else {
					timer = setInterval(function () {
						timerStart()
					}, 1000)
					this.textContent = '暂停'
				}
			})

			function timerStart() {
				times--
				format(times)
				if (times === 0) {
					alert('计时结束')
					clearInterval(timer)
					restart()
				}
			}

			function format(t) {
				var ml = ss[0]
				var sl = ss[1]

				var m = Math.floor(t / 60)
				var s = t - m * 60

				ml.textContent = m < 10 ? '0' + m : m
				sl.textContent = s < 10 ? '0' + s : s
				button.textContent = timer ? '暂停' : '启动'
			}

			function restart() {
				times = 40
				timer = null
				format(times)
			}
		}
		main()
	</script>
</body>

</html>